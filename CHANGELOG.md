# 更新日志

## [0.2.0] - 2024-09-29

### 🚀 代理服务功能

#### 代理服务器实现
- ✅ 完整的 TCP/UDP 代理服务器
- ✅ 双向数据转发机制
- ✅ 并发连接处理
- ✅ 服务状态管理 (启动/停止/运行检测)

#### TCP 代理功能
- ✅ TCP 连接转发到选定节点
- ✅ 异步双向数据流传输
- ✅ 连接错误处理和日志记录
- ✅ 自动连接清理机制

#### UDP 代理功能
- ✅ UDP 数据包转发
- ✅ 会话管理 (按客户端地址区分)
- ✅ 反向数据转发任务
- ✅ 自动会话清理

#### 服务管理增强
- ✅ 实际的 `start` 命令 - 启动完整代理服务
- ✅ 改进的 `status` 命令 - 端口占用检测
- ✅ 服务运行状态检查机制
- ✅ 优雅的停止信号处理

#### 错误处理
- ✅ 节点连接失败检测
- ✅ 详细的错误日志记录
- ✅ 服务启动前的配置验证
- ✅ 网络异常恢复机制

### 🔧 技术改进
- **代理架构**: Arc + RwLock 多线程安全设计
- **网络层**: TCP/UDP 双协议支持
- **会话管理**: HashMap 缓存 UDP 连接
- **异步处理**: 完全异步的并发模型
- **内存安全**: 智能指针和生命周期管理

## [0.1.0] - 2024-09-29

### 🎉 项目初始化
- 创建 Rust 项目基础结构
- 设置 MIT 许可证和项目文档
- 配置 Git 仓库和 .gitignore

### ✨ 核心功能实现

#### 订阅管理
- ✅ 支持 Clash YAML 配置格式解析
- ✅ 支持 Shadowsocks (ss://) 链接格式解析
- ✅ Base64 编码订阅内容自动解码
- ✅ 多种订阅格式智能识别

#### 节点管理
- ✅ 节点延迟测试 (TCP 连接测试)
- ✅ 按延迟自动排序节点
- ✅ 节点信息显示 (名称、服务器、协议、延迟)
- ✅ 节点选择和切换功能

#### 游戏检测
- ✅ 系统进程扫描
- ✅ 支持饥荒联机版 (Don't Starve Together) 检测
- ✅ 进程名和路径匹配算法

#### 配置管理
- ✅ 本地 YAML 配置文件
- ✅ 配置目录自动创建 (~/.config/clashfun/)
- ✅ 订阅链接和选中节点持久化存储

#### CLI 界面
- ✅ `clashfun set-subscription <url>` - 设置订阅链接
- ✅ `clashfun nodes` - 列出并测试所有节点
- ✅ `clashfun select-node <name>` - 选择节点
- ✅ `clashfun status` - 显示详细状态信息
- ✅ `clashfun detect-game` - 检测运行中的游戏
- ✅ `clashfun start/stop` - 服务控制 (框架)
- ✅ `clashfun update/uninstall` - 管理命令 (框架)

### 🏗️ 技术架构
- **语言**: Rust (2021 edition)
- **异步运行时**: tokio 1.0
- **CLI 框架**: clap 4.0
- **HTTP 客户端**: reqwest 0.11
- **序列化**: serde + serde_yaml + serde_json
- **系统监控**: sysinfo 0.29
- **错误处理**: anyhow + thiserror

### 📦 依赖管理
- 添加了所有必要的 Rust 依赖
- 配置了跨平台兼容性
- 设置了优化的编译选项

### 🧪 测试状态
- ✅ 所有模块编译通过
- ✅ CLI 命令功能验证
- ✅ 配置文件读写测试
- ✅ 游戏检测功能测试

### 🔄 下一阶段 (MVP 完善)
- [ ] 实现实际的代理服务启动
- [ ] UDP 流量转发功能
- [ ] 自动游戏流量识别
- [ ] 节点故障自动切换
- [ ] 性能优化和稳定性测试